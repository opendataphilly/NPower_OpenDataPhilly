{% extends "template1.html" %}
{% load ratings %}
{% load pagination_tags %}
{% load sorting_tags %}

{% block js_ready %}
	<script>
		$(document).ready(function () {
			odp.getTags();
			odp.setupSearchInput();

			odp.setupNominate();
		});
	</script>
{% endblock %}

{% block center_container %}
	<div id="title">Nominate Data</div>
	<div id="description">Description and instructions here</div>


	<div id="form_container" class="nomination_form">
		<form action="post/" method="POST">
			{% csrf_token %}
				{% if form.errors %}
				<div class="error_message">The form has errors. Please try again.</div>
			{% endif %}
			<table>
				{{form.as_table}}
				<tr><td>&nbsp;</td><td><input class="button" type="submit" value="submit"/></td></tr>
			</table>
		</form>
	</div>
	<div id="center_header">
      	<div id="n_search">
			<form method="GET" id="n_search_form" >
				<div id="n_search_qs">
					<input type="text" id="nqs" value="Search for nominations" />
				</div>
			</form>
			<div id="n_search_img"></div>
			{% if user.is_authenticated %}
				<div id="nominate_button" class="button">Add a Nomination</div>
			{% else %}
				<div id="nominate_login"><a href="/accounts/login/?next={{ request.get_full_path }}">Login</a> to Nominate Data</div>
			{% endif %}
		</div>
    </div>
	<div id="results_header">
		<div id="results_info">
			<div id="count">{{results.count}} RESULTS</div>
			<div id="filter">
				<ul>
					<li id="filter_mine" class="nom_filter"><a href="javascript:void()" onClick="odp.getNomFiltered();return false;" class="url_image"></a></li>
					<li class="info_label">FILTER:</li>
				</ul>
			</div>
			<div id="sort">
				<ul>
					<li id="sort_rating_score">{% anchor rating_score Votes %}</li>
					<li id="sort_suggested_date">{% anchor suggested_date Date %}<li>
					<li class="info_label">SORT:</li>
				</ul>
			</div>
		</div>
	</div>
{% autosort suggestions %}
{% autopaginate suggestions 6 %}
	<div id="suggestions">
		<ul id="suggestion_list">
			{% for s in suggestions %}
				{% rating_by_request request on s.rating as vote %}
				<li class="resource">
					<div id="nom_votes"><div id="nom_votes_number">{{s.rating_votes}}</div><div id="nom_votes_text">votes</div></div>
					<div id="nom_text">{{s}} <div id="nom_date">Posted: {{s.suggested_date|date:"SHORT_DATE_FORMAT"}}</div></div>
					<div id="nom_byline">
						{% if vote %}
							<a id="nom_unvote" href="unvote/{{s.id}}/">Undo vote</a>
						{% endif %}
						Posted By: {{s.suggested_by}}
					</div>
					{% if user.is_authenticated %}
						{% if not vote %}
							<div id="nom_voted" class="button" onclick="window.location='vote/{{s.id}}'"><img src="/static/images/icon_thumb_white.png" />VOTE FOR THIS</div>
						{% else %}
							<div id="nom_voted"><img src="/static/images/icon_thumb.png" />YOU VOTED!</div>
						{% endif %}
					{% endif %}
				</li>
			{% empty %}
				<li class="resource">No nominations yet! What would you like to see added to this site?</li>
			{% endfor %}
		</ul>

	</div>
	<div id="pager">{% paginate %}</div>
{% endblock %}